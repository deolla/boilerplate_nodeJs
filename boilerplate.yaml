openapi: 3.0.0
info:
  title: Authentication API
  description: The API
  version: 1.0.0
  license:
    name: MIT
    url: https://example.com/license
servers:
  - url: https://example.com
    description: Local server
paths:
  # Register and login routes using the default email and password, social accounts, and magic links
  /auth/register:
    post:
      tags: [Authentication]
      summary: Register a new user
      operationId: registerUser
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                firstName:
                  type: string
                lastName:
                  type: string
                phone:
                  type: string
                email:
                  type: string
                  format: email
                password:
                  type: string
      responses:
        "200":
          description: User registered successfully
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/User"
        "400":
          description: Bad request

  /auth/login:
    post:
      tags: [Authentication]
      summary: Login a user
      operationId: loginUser
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                email:
                  type: string
                  format: email
                password:
                  type: string
      responses:
        "200":
          description: User logged in successfully
        "401":
          description: Invalid credentials

  /auth/social/{provider}:
    get:
      tags: [Authentication]
      summary: Social authentication
      operationId: socialAuth
      parameters:
        - name: provider
          in: path
          required: true
          schema:
            type: string
            enum: [google, facebook, twitter]
      responses:
        "200":
          description: Social authentication success
        "400":
          description: Social authentication failed

  /auth/magic-link:
    post:
      tags: [Authentication]
      summary: Send magic link
      operationId: sendMagicLink
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                email:
                  type: string
                  format: email
      responses:
        "200":
          description: Magic link sent
        "400":
          description: Bad request

  /auth/magic-link/verify:
    post:
      tags: [Authentication]
      summary: Verify magic link
      operationId: verifyMagicLink
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                token:
                  type: string
      responses:
        "200":
          description: Magic link verified
        "400":
          description: Bad request

  /auth/change-password:
    post:
      tags: [Authentication]
      summary: Change user password
      operationId: changePassword
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                oldPassword:
                  type: string
                newPassword:
                  type: string
      responses:
        "200":
          description: Password changed successfully
        "400":
          description: Bad request
        "401":
          description: Unauthorized

  /users:
    get:
      tags: [User]
      summary: Get a list of users
      responses:
        "200":
          description: List of users
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/UserListResponse"
        "401":
          description: Unauthorized
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorResponse"

  /users/{userId}:
    get:
      tags: [User]
      summary: Get a user's details
      parameters:
        - name: userId
          in: path
          required: true
          schema:
            type: string
      responses:
        "200":
          description: User profile
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/UserResponse"
        "404":
          description: Not Found
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorResponse"
    put:
      tags: [User]
      summary: Update a user's profile
      parameters:
        - name: userId
          in: path
          required: true
          schema:
            type: string
      requestBody:
        required: true
        content:
          multipart/form-data:
            schema:
              $ref: "#/components/schemas/UpdateUserProfile"
      responses:
        "200":
          description: User profile updated
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/UserResponse"
        "400":
          description: Bad Request
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorResponse"
        "404":
          description: Not Found
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorResponse"

  # payment methods and routes
  /payments/stripe:
    post:
      tags: [Payment]
      summary: Process payment via Stripe
      operationId: processStripePayment
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                amount:
                  type: number
                currency:
                  type: string
                token:
                  type: string
      responses:
        "200":
          description: Payment successful
        "400":
          description: Bad request
        "401":
          description: Unauthorized

  /payments/flutterwave:
    post:
      tags: [Payment]
      summary: Process payment via Flutterwave
      operationId: processFlutterwavePayment
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                amount:
                  type: number
                currency:
                  type: string
                tx_ref:
                  type: string
                redirect_url:
                  type: string
                payment_type:
                  type: string
      responses:
        "200":
          description: Payment successful
        "400":
          description: Bad request
        "401":
          description: Unauthorized

  /payments/lemonsqueezy:
    post:
      tags: [Payment]
      summary: Process payment via LemonSqueezy
      operationId: processLemonSqueezyPayment
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                amount:
                  type: number
                currency:
                  type: string
                reference:
                  type: string
      responses:
        "200":
          description: Payment successful
        "400":
          description: Bad request
        "401":
          description: Unauthorized

  /content/edit:
    put:
      tags: [Content]
      summary: Edit content
      operationId: editContent
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                contentId:
                  type: string
                newContent:
                  type: string
      responses:
        "200":
          description: Content edited successfully
        "400":
          description: Bad request
        "401":
          description: Unauthorized
  /content:
    post:
      tags: [Content]
      summary: Create content
      operationId: createContent
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                title:
                  type: string
                body:
                  type: string
      responses:
        "201":
          description: Content created successfully
        "400":
          description: Bad request
        "401":
          description: Unauthorized

    get:
      tags: [Content]
      summary: Get all content
      operationId: getAllContent
      responses:
        "200":
          description: Content retrieved successfully
          content:
            application/json:
              schema:
                type: array
                items:
                  type: object
                  properties:
                    id:
                      type: string
                    title:
                      type: string
                    body:
                      type: string
        "400":
          description: Bad request
        "401":
          description: Unauthorized

  /content/{contentId}:
    get:
      tags: [Content]
      summary: Get content by ID
      operationId: getContentById
      parameters:
        - name: contentId
          in: path
          required: true
          schema:
            type: string
      responses:
        "200":
          description: Content retrieved successfully
          content:
            application/json:
              schema:
                type: object
                properties:
                  id:
                    type: string
                  title:
                    type: string
                  body:
                    type: string
        "400":
          description: Bad request
        "401":
          description: Unauthorized
        "404":
          description: Content not found

  # Add a new path for getting chart data
  /chart:
    get:
      tags: [Chart]
      summary: Get chart data
      operationId: getChartData
      responses:
        "200":
          description: Chart data retrieved successfully
          content:
            application/json:
              schema:
                type: object
                properties:
                  chartData:
                    type: array
                    items:
                      type: object
                      properties:
                        x:
                          type: number
                        y:
                          type: number
        "400":
          description: Bad request
        "401":
          description: Unauthorized

  /organisations:
    post:
      tags: [Organisations]
      summary: Create a new organisation
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/CreateOrganisation"
      responses:
        "201":
          description: Organisation created successfully
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/OrganisationResponse"
        "400":
          description: Bad Request
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorResponse"
    get:
      tags: [Organisations]
      summary: Get a list of organisations
      responses:
        "200":
          description: List of organisations
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/OrganisationListResponse"
        "401":
          description: Unauthorized
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorResponse"

  /organisations/{orgId}:
    get:
      tags: [Organisations]
      summary: Get an organisation's details
      parameters:
        - name: orgId
          in: path
          required: true
          schema:
            type: string
      responses:
        "200":
          description: Organisation details
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/OrganisationDetails"
        "404":
          description: Not Found
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorResponse"

  /organisations/{orgId}/users:
    post:
      tags: [Organisations]
      summary: Add a user to an organisation
      parameters:
        - name: orgId
          in: path
          required: true
          schema:
            type: string
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/AddUserToOrganisation"
      responses:
        "201":
          description: User added to organisation successfully
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/OrganisationUserResponse"
        "400":
          description: Bad Request
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorResponse"
        "404":
          description: Organisation or user not found
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorResponse"

  /organisations/{orgId}/invite:
    post:
      tags: [Organisations]
      summary: Generate an invite link
      description: Creates an invite link for a user
      parameters:
        - name: orgId
          in: path
          required: true
          schema:
            type: string
      requestBody:
        content:
          application/json:
            schema:
              type: object
              required:
                - email
              properties:
                email:
                  type: string
                  description: User email
      responses:
        200:
          description: Invite link generated successfully
          content:
            application/json:
              schema:
                type: object
                properties:
                  link:
                    type: string
                    description: Invite link
                  status:
                    type: boolean
                  expirationDate:
                    type: string
                    description: when the invitation will expire
        400:
          description: Invalid request
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorResponse"

        401:
          description: Unauthorized access to invite a user
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorResponse"
        403:
          description: Don't have the permission to add a user
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorResponse"

        500:
          description: Internal server error
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorResponse"

  # contact form
  /organisations/{orgId}/contact:
    post:
      tags: [Organisations]
      summary: contact an organisations
      parameters:
        - name: orgId
          in: path
          required: true
          schema:
            type: string
      requestBody:
        content:
          application/json:
            schema:
              type: object
              properties:
                email:
                  type: string
                  example: janedoe@domain.com
                name:
                  type: string
                  example: Jane Doe
                message:
                  type: string
      responses:
        201:
          description: Contact form submitted successfully
          content:
            application/json:
              schema:
                type: object
                properties:
                  message:
                    type: string
                    example: Details sent successfully
                  status:
                    type: boolean
        400:
          description: Request body missing a required field, or contains an invalid data.
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorResponse"
        404:
          description: The organisation you're trying to contact does not exist
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorResponse"

  # dashboard
  /dashboard:
    get:
      tags: [Dashboard]
      summary: Fetch dashboard data
      responses:
        200:
          description: get an authenticated user dashboard data
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/DashboardResponse"
        401:
          description: Unauthorized request
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorResponse"

  /settings:
    get:
      tags: [Settings]
      summary: Get settings
      responses:
        "200":
          description: Settings data
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/SettingsResponse"
        "401":
          description: Unauthorized
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorResponse"
    put:
      tags: [Settings]
      summary: Update settings
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/UpdateSettings"
      responses:
        "200":
          description: Settings updated
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/SettingsResponse"
        "400":
          description: Bad Request
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorResponse"
        "401":
          description: Unauthorized
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorResponse"

  /export-data:
    get:
      tags: [Export]
      summary: Export user data
      responses:
        "200":
          description: User data export initiated
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ExportDataResponse"
        "401":
          description: Unauthorized
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorResponse"

  /messaging/email:
    post:
      tags: [Messaging]
      summary: Send email using default template and background process
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/EmailMessage"
      responses:
        200:
          description: Email sent successfully
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/EmailSentResponse"
        400:
          description: Bad Request
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorResponse"

  /notifications:
    post:
      tags: [Notifications]
      summary: Send a notification
      description: Endpoint to send notifications via email or other channels.
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                message:
                  type: string
                subject:
                  type: string
              required:
                - message
      responses:
        200:
          description: Notification sent successfully
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/NotificationResponse"
        400:
          description: Bad Request
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorResponse"

  /cookies/gdpr:
    get:
      tags: [Cookies (GDPR)]
      summary: Get GDPR cookies information
      description: Retrieve information about GDPR compliance and cookies usage.
      responses:
        200:
          description: GDPR cookies information retrieved successfully
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/GDPRCookiesResponse"
        401:
          description: Unauthorized
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorResponse"

  /waitlist:
    post:
      tags: [Waitlist]
      summary: Join the waitlist
      description: Register a user to a waitlist for a service or feature.
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                email:
                  type: string
              required:
                - email
      responses:
        200:
          description: User added to the waitlist
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/WaitlistResponse"
        400:
          description: Bad Request
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorResponse"

  /superadmin/email-templates:
    get:
      tags: [Super Admin]
      summary: Get email templates
      description: Retrieve email templates managed by the Superadmin.
      responses:
        200:
          description: Email templates retrieved successfully
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/EmailTemplatesResponse"
        401:
          description: Unauthorized
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorResponse"

components:
  securitySchemes:
    bearerAuth:
      type: http
      scheme: bearer
      bearerFormat: JWT

  schemas:
    ApiResponse:
      type: object
      properties:
        status:
          type: string
        message:
          type: string
        data:
          type: object

    ErrorResponse:
      type: object
      properties:
        error:
          type: string
        status:
          type: string
        message:
          type: string
        statusCode:
          type: integer
        data:
          type: object
          nullable: true

    DashboardResponse:
      type: object
      properties:
        status:
          type: boolean
        user:
          type: object
          properties:
            id:
              type: string
            email:
              type: string
            photo_url:
              type: string
            verified:
              type: boolean
        organisations:
          description: organisations the user belongs to
          type: array
          items:
            type: object
            properties:
              id:
                type: string
              name:
                type: string
        active_organisation:
          type: object
          properties:
            id:
              type: string
            name:
              type: string
            description:
              type: string
        notifications:
          type: array
          items:
            type: object
            properties:
              message:
                type: string
              is_read:
                type: boolean
                example: false
        invitations:
          type: array
          items:
            type: object
            properties:
              inviter:
                type: object
              organisation:
                type: object
              expirationDate:
                type: string
              status:
                type: string
                enum:
                  - pending
                  - accepted
                  - denied
                  - revoked
                description: the invitation status

    CreateOrganisation:
      type: object
      properties:
        name:
          type: string
      required:
        - name

    AddUserToOrganisation:
      type: object
      properties:
        userId:
          type: string
      required:
        - userId

    UpdateUserProfile:
      type: object
      properties:
        firstName:
          type: string
        lastName:
          type: string
        email:
          type: string
        phone:
          type: string
        photoUrl:
          type: string
          format: binary

    UpdateSettings:
      type: object
      properties:
        setting1:
          type: string
        setting2:
          type: string

    UserResponse:
      type: object
      allOf:
        - $ref: "#/components/schemas/ApiResponse"
        - type: object
          properties:
            data:
              type: object
              properties:
                userId:
                  type: string
                firstName:
                  type: string
                lastName:
                  type: string
                email:
                  type: string
                phone:
                  type: string
                photoUrl:
                  type: string
                  format: binary

    OrganisationDetails:
      type: object
      allOf:
        - $ref: "#/components/schemas/ApiResponse"
        - type: object
          properties:
            data:
              type: object
              properties:
                orgId:
                  type: string
                name:
                  type: string
                description:
                  type: string

    OrganisationResponse:
      type: object
      allOf:
        - $ref: "#/components/schemas/ApiResponse"
        - type: object
          properties:
            data:
              type: object
              properties:
                orgId:
                  type: string
                name:
                  type: string
                description:
                  type: string

    Organisation:
      type: object
      properties:
        orgId:
          type: string
        name:
          type: string
        description:
          type: string

    OrganisationListResponse:
      type: object
      properties:
        message:
          type: string
        status:
          type: string
        data:
          type: array
          items:
            $ref: "#/components/schemas/Organisation"

    OrganisationUserResponse:
      type: object
      allOf:
        - $ref: "#/components/schemas/ApiResponse"
        - type: object
          properties:
            data:
              type: object
              properties:
                orgId:
                  type: string
                userId:
                  type: string

    User:
      type: object
      properties:
        userId:
          type: string
        firstName:
          type: string
        lastName:
          type: string
        email:
          type: string
        phone:
          type: string

    UserListResponse:
      type: object
      properties:
        message:
          type: string
        status:
          type: string
        data:
          type: array
          items:
            $ref: "#/components/schemas/User"

    SettingsResponse:
      type: object
      allOf:
        - $ref: "#/components/schemas/ApiResponse"
        - type: object
          properties:
            data:
              type: object
              properties:
                setting1:
                  type: string
                setting2:
                  type: string

    ExportDataResponse:
      type: object
      allOf:
        - $ref: "#/components/schemas/ApiResponse"
        - type: object
          properties:
            data:
              type: array
              items:
                $ref: "#/components/schemas/User"

    EmailMessage:
      type: object
      properties:
        from:
          type: string
        to:
          type: string
        subject:
          type: string
        content:
          type: string

    EmailSentResponse:
      type: object
      properties:
        status:
          type: string
        messageId:
          type: string

    WaitlistRequest:
      type: object
      properties:
        email:
          type: string
        name:
          type: string

    WaitlistResponse:
      type: object
      properties:
        status:
          type: string
        message:
          type: string

    EmailTemplatesListResponse:
      type: array
      items:
        type: object
        properties:
          templateId:
            type: string
          name:
            type: string
          description:
            type: string

    NotificationResponse:
      type: object
      properties:
        notifications:
          type: array
          items:
            type: object
            properties:
              id:
                type: string
              message:
                type: string
              timestamp:
                type: string

    GDPRCookiesResponse:
      type: object
      properties:
        status:
          type: string
        message:
          type: string
        gdprCookiesContent:
          type: string
        privacyPolicyContent:
          type: string
        aboutUsContent:
          type: string

    EmailTemplatesResponse:
      type: object
      properties:
        templates:
          type: array
          items:
            type: object
            properties:
              templateId:
                type: string
              name:
                type: string
              description:
                type: string

security:
  - bearerAuth: []
